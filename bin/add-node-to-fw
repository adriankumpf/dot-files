#!/bin/bash

# After updaing node with fnm it may happen that the macOS firewall cannot
# handle the re-linking of node binaries. In that case remove node:
#
# $ sudo /usr/libexec/ApplicationFirewall/socketfilterfw --remove ~/.config/fnm/bin/node
#
# and reboot. Execute this script afterwards.

set -e

sudo /usr/libexec/ApplicationFirewall/socketfilterfw --remove /usr/local/bin/node
cp -pf "$(which node)" /usr/local/bin/node
sudo /usr/libexec/ApplicationFirewall/socketfilterfw --add /usr/local/bin/node
